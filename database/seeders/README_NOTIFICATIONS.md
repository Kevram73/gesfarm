# üîî R√©solution du Probl√®me de Table Notifications

## ‚ùå Probl√®me Identifi√©

```
SQLSTATE[42S02]: Base table or view not found: 1146 Table 'gesfarm.notifications' doesn't exist
```

L'erreur indique que la table `notifications` n'existe pas dans la base de donn√©es, bien que la migration et le mod√®le existent.

## ‚úÖ Solutions Disponibles

### Option 1: Ex√©cuter les Migrations Laravel (Recommand√©)

```bash
cd C:\Users\LENOVO\Documents\codes\gesfarm
php artisan migrate
```

### Option 2: Cr√©er Manuellement la Table (Alternative)

Si les migrations Laravel ne fonctionnent pas, utilisez les scripts fournis :

#### Avec PowerShell :
```powershell
cd C:\Users\LENOVO\Documents\codes\gesfarm\database\seeders
.\run_notifications_setup.ps1
```

#### Avec Batch :
```cmd
cd C:\Users\LENOVO\Documents\codes\gesfarm\database\seeders
run_notifications_setup.bat
```

#### Manuellement avec MySQL :
```sql
mysql -u root -p gesfarm < create_notifications_table.sql
```

## üìã Fichiers Cr√©√©s

1. **`create_notifications_table.sql`** - Script SQL pour cr√©er la table et ins√©rer les donn√©es
2. **`run_notifications_setup.ps1`** - Script PowerShell automatis√©
3. **`run_notifications_setup.bat`** - Script Batch pour Windows
4. **`README_NOTIFICATIONS.md`** - Ce fichier d'instructions

## üóÉÔ∏è Structure de la Table

```sql
CREATE TABLE `notifications` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,
  `type` varchar(255) NOT NULL,
  `title` varchar(255) NOT NULL,
  `message` text NOT NULL,
  `priority` enum('low','medium','high','urgent') NOT NULL DEFAULT 'medium',
  `status` enum('unread','read','archived') NOT NULL DEFAULT 'unread',
  `data` json DEFAULT NULL,
  `read_at` timestamp NULL DEFAULT NULL,
  `scheduled_at` timestamp NULL DEFAULT NULL,
  `user_id` bigint(20) unsigned DEFAULT NULL,
  `related_entity_id` bigint(20) unsigned DEFAULT NULL,
  `related_entity_type` varchar(255) DEFAULT NULL,
  `created_at` timestamp NULL DEFAULT NULL,
  `updated_at` timestamp NULL DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `notifications_type_status_index` (`type`,`status`),
  KEY `notifications_user_id_status_index` (`user_id`,`status`),
  KEY `notifications_scheduled_at_index` (`scheduled_at`),
  KEY `notifications_user_id_foreign` (`user_id`),
  CONSTRAINT `notifications_user_id_foreign` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
```

## üìä Donn√©es d'Exemple

Le script ins√®re **10 notifications d'exemple** avec diff√©rents types :

- **Stock Alert** - Alerte de stock faible
- **Vaccination Reminder** - Rappel de vaccination
- **Egg Collection** - Collecte d'≈ìufs
- **Weather Alert** - Alerte m√©t√©o
- **Maintenance Reminder** - Rappel de maintenance
- **Production Milestone** - Objectif de production atteint
- **Health Alert** - Alerte sant√©
- **Financial Alert** - Alerte financi√®re
- **Task Reminder** - Rappel de t√¢che
- **System Backup** - Sauvegarde syst√®me

## üîß V√©rification

Apr√®s avoir ex√©cut√© le script, v√©rifiez que la table existe :

```sql
USE gesfarm;
SHOW TABLES LIKE 'notifications';
SELECT COUNT(*) FROM notifications;
```

## üöÄ Test de l'API

Une fois la table cr√©√©e, testez l'endpoint :

```
GET http://localhost:8000/api/notifications?per_page=5
```

## üìù Notes Importantes

1. **Pr√©requis** : La table `users` doit exister (cl√© √©trang√®re)
2. **Permissions** : L'utilisateur MySQL doit avoir les droits de cr√©ation de table
3. **Base de donn√©es** : Assurez-vous que la base `gesfarm` existe
4. **Configuration** : Adaptez les param√®tres de connexion dans les scripts si n√©cessaire

## üÜò En Cas de Probl√®me

Si vous rencontrez des erreurs :

1. V√©rifiez que MySQL est d√©marr√©
2. V√©rifiez que la base de donn√©es `gesfarm` existe
3. V√©rifiez que l'utilisateur a les permissions n√©cessaires
4. V√©rifiez que la table `users` existe
5. Consultez les logs MySQL pour plus de d√©tails

## üìû Support

Pour toute question ou probl√®me, consultez la documentation Laravel ou les logs d'erreur.
