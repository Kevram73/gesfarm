# Variables d'Environnement pour Vercel

## üîß Configuration des Variables dans Vercel

### 1. Acc√©dez au Dashboard Vercel
1. Allez sur [vercel.com](https://vercel.com)
2. S√©lectionnez votre projet GESFARM
3. Allez dans **Settings** > **Environment Variables**

### 2. Variables Obligatoires

#### Application
```bash
APP_NAME=GESFARM
APP_ENV=production
APP_KEY=base64:your-generated-app-key-here
APP_DEBUG=false
APP_URL=https://your-app-name.vercel.app
```

#### Base de Donn√©es
```bash
DB_CONNECTION=mysql
DB_HOST=your-database-host
DB_PORT=3306
DB_DATABASE=your-database-name
DB_USERNAME=your-database-username
DB_PASSWORD=your-database-password
```

#### Cache et Sessions (optimis√©s pour serverless)
```bash
CACHE_DRIVER=array
SESSION_DRIVER=array
QUEUE_CONNECTION=sync
MAIL_MAILER=log
```

#### Sanctum (Authentification API)
```bash
SANCTUM_STATEFUL_DOMAINS=localhost,127.0.0.1,localhost:3000,localhost:3001,your-frontend-domain.vercel.app
SESSION_DOMAIN=null
```

### 3. G√©n√©ration de la Cl√© d'Application

Ex√©cutez cette commande localement pour g√©n√©rer une cl√© :

```bash
php artisan key:generate --show
```

Copiez la cl√© g√©n√©r√©e et ajoutez-la comme variable `APP_KEY` dans Vercel.

### 4. Configuration de la Base de Donn√©es

#### Option 1: PlanetScale (Recommand√© - Gratuit)
1. Cr√©ez un compte sur [PlanetScale](https://planetscale.com)
2. Cr√©ez une nouvelle base de donn√©es
3. Copiez les credentials :
   - Host: `aws.connect.psdb.cloud`
   - Database: `votre-nom-db`
   - Username: `votre-username`
   - Password: `votre-password`

#### Option 2: Railway (Gratuit)
1. Cr√©ez un compte sur [Railway](https://railway.app)
2. Cr√©ez un service MySQL
3. Copiez les credentials depuis le dashboard

#### Option 3: Supabase (Gratuit)
1. Cr√©ez un compte sur [Supabase](https://supabase.com)
2. Cr√©ez un nouveau projet
3. Utilisez les credentials PostgreSQL

### 5. Configuration CORS

Ajoutez ces variables pour la gestion CORS :

```bash
CORS_ALLOWED_ORIGINS=https://your-frontend.vercel.app,https://*.vercel.app
```

### 6. Variables Optionnelles

#### Mail (pour les notifications)
```bash
MAIL_MAILER=smtp
MAIL_HOST=smtp.gmail.com
MAIL_PORT=587
MAIL_USERNAME=your-email@gmail.com
MAIL_PASSWORD=your-app-password
MAIL_ENCRYPTION=tls
MAIL_FROM_ADDRESS=your-email@gmail.com
MAIL_FROM_NAME=GESFARM
```

#### AWS S3 (pour le stockage de fichiers)
```bash
AWS_ACCESS_KEY_ID=your-access-key
AWS_SECRET_ACCESS_KEY=your-secret-key
AWS_DEFAULT_REGION=us-east-1
AWS_BUCKET=your-bucket-name
```

### 7. Ordre de Configuration

1. **D'abord** : Configurez toutes les variables d'environnement
2. **Ensuite** : D√©ployez l'application
3. **Enfin** : Ex√©cutez les migrations

### 8. Commandes Post-D√©ploiement

```bash
# R√©cup√©rer les variables d'environnement
vercel env pull .env.local

# Ex√©cuter les migrations
php artisan migrate --force

# Ex√©cuter les seeders (optionnel)
php artisan db:seed --force
```

### 9. Test de l'API

Une fois d√©ploy√©, testez votre API :

```bash
# Test de base
curl https://your-app.vercel.app/api/

# Test d'authentification
curl -X POST https://your-app.vercel.app/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email":"test@example.com","password":"password"}'
```

### 10. URLs de l'API

Apr√®s d√©ploiement, votre API sera disponible √† :
- **Base URL** : `https://your-app.vercel.app`
- **API Routes** : `https://your-app.vercel.app/api/`
- **Sanctum** : `https://your-app.vercel.app/sanctum/`

### 11. Mise √† Jour du Frontend

Mettez √† jour l'URL de l'API dans votre frontend Next.js :

```typescript
// lib/services/api.ts
const baseURL = "https://your-app.vercel.app/api"
```

### 12. Monitoring

- **Logs** : `vercel logs`
- **Logs en temps r√©el** : `vercel logs --follow`
- **M√©triques** : Dashboard Vercel > Analytics

## ‚ö†Ô∏è Notes Importantes

- Les variables d'environnement sont sensibles, ne les partagez jamais
- Red√©ployez apr√®s avoir modifi√© les variables d'environnement
- Vercel a une limite de 30 secondes par requ√™te
- Utilisez des services externes pour le stockage de fichiers
- Configurez CORS correctement pour √©viter les erreurs
